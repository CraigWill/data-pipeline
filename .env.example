# 实时数据管道系统 - 环境变量配置示例
# 需求: 8.6, 10.2 - 支持通过环境变量配置系统参数
#
# 使用方法:
#   1. 复制此文件为 .env: cp .env.example .env
#   2. 根据实际环境修改配置值
#   3. 启动服务: docker-compose up -d
#
# 注意: .env 文件包含敏感信息，不应提交到版本控制系统

# ============================================
# 数据库配置（必需）
# ============================================
# OceanBase数据库主机地址
DATABASE_HOST=oceanbase-host.example.com

# 数据库端口（默认: 2881）
DATABASE_PORT=2881

# 数据库用户名
DATABASE_USERNAME=root

# 数据库密码（请使用强密码）
DATABASE_PASSWORD=your-secure-password

# 要监控的Schema
DATABASE_SCHEMA=mydb

# 要监控的表列表（逗号分隔，* 表示所有表）
DATABASE_TABLES=users,orders,products

# ============================================
# DataHub配置（必需）
# ============================================
# DataHub服务端点
# 华东1（杭州）: https://dh-cn-hangzhou.aliyuncs.com
# 华北2（北京）: https://dh-cn-beijing.aliyuncs.com
# 华东2（上海）: https://dh-cn-shanghai.aliyuncs.com
DATAHUB_ENDPOINT=https://dh-cn-hangzhou.aliyuncs.com

# DataHub访问ID（阿里云AccessKey ID）
DATAHUB_ACCESS_ID=your-access-key-id

# DataHub访问密钥（阿里云AccessKey Secret）
DATAHUB_ACCESS_KEY=your-access-key-secret

# DataHub项目名称
DATAHUB_PROJECT=realtime-pipeline

# DataHub主题名称
DATAHUB_TOPIC=cdc-events

# DataHub消费者组名称
DATAHUB_CONSUMER_GROUP=cdc-collector-group

# ============================================
# Flink JobManager配置
# ============================================
# JobManager RPC地址（通常不需要修改）
JOB_MANAGER_RPC_ADDRESS=jobmanager

# JobManager RPC端口
JOB_MANAGER_RPC_PORT=6123

# JobManager堆内存大小
JOB_MANAGER_HEAP_SIZE=1024m

# REST API端口
REST_PORT=8081

# Blob服务器端口
BLOB_SERVER_PORT=6124

# 默认并行度
PARALLELISM_DEFAULT=4

# ============================================
# Checkpoint配置
# ============================================
# Checkpoint间隔（毫秒，默认5分钟）
CHECKPOINT_INTERVAL=300000

# Checkpoint存储目录
CHECKPOINT_DIR=file:///opt/flink/checkpoints

# Savepoint存储目录
SAVEPOINT_DIR=file:///opt/flink/savepoints

# 状态后端类型（hashmap 或 rocksdb）
STATE_BACKEND=hashmap

# ============================================
# 高可用配置（可选）
# ============================================
# 高可用模式（NONE 或 zookeeper）
# 启用HA: docker-compose --profile ha up -d
HA_MODE=zookeeper

# ZooKeeper集群地址（启用HA时必需）
HA_ZOOKEEPER_QUORUM=zookeeper:2181

# ZooKeeper根路径
HA_ZOOKEEPER_PATH_ROOT=/flink

# 集群ID
HA_CLUSTER_ID=/realtime-pipeline

# HA存储目录
HA_STORAGE_DIR=file:///opt/flink/ha

# ============================================
# Flink TaskManager配置
# ============================================
# TaskManager堆内存大小
TASK_MANAGER_HEAP_SIZE=1024m

# TaskManager进程总内存
TASK_MANAGER_MEMORY_PROCESS_SIZE=1728m

# TaskManager托管内存
TASK_MANAGER_MEMORY_MANAGED_SIZE=512m

# TaskManager任务槽数量
TASK_MANAGER_NUMBER_OF_TASK_SLOTS=4

# TaskManager RPC端口
TASK_MANAGER_RPC_PORT=6122

# TaskManager数据交换端口
TASK_MANAGER_DATA_PORT=6121

# 网络内存最小值
TASK_MANAGER_NETWORK_MEMORY_MIN=64m

# 网络内存最大值
TASK_MANAGER_NETWORK_MEMORY_MAX=256m

# ============================================
# CDC Collector配置
# ============================================
# 重试最大次数
RETRY_MAX_ATTEMPTS=3

# 重试间隔（毫秒）
RETRY_BACKOFF_MS=2000

# 监控端口
MONITORING_PORT=8080

# 日志级别（DEBUG, INFO, WARN, ERROR）
LOG_LEVEL=INFO

# 堆内存大小
HEAP_SIZE=512m

# ============================================
# 额外的Java选项（可选）
# ============================================
# JobManager额外的Java选项
# EXTRA_JAVA_OPTS=-Duser.timezone=Asia/Shanghai

# ============================================
# Docker Compose配置
# ============================================
# Compose项目名称（用于容器和网络命名）
COMPOSE_PROJECT_NAME=realtime-pipeline

# ============================================
# 生产环境建议
# ============================================
# 1. 使用强密码和密钥
# 2. 定期轮换访问密钥
# 3. 使用专用的数据库用户（最小权限原则）
# 4. 启用SSL/TLS连接
# 5. 配置防火墙规则
# 6. 定期备份Checkpoint和Savepoint数据
# 7. 监控资源使用情况
# 8. 配置日志轮转
# 9. 使用密钥管理服务（如阿里云KMS）
# 10. 定期更新镜像和依赖
